---
title: "Homework 2 for P8131"
author: "Roxy Zhang"
date: "2/18/2022"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

# Question 1

## Format data

```{r}
dose = c(0:4)
death = c(2, 8, 15, 23, 27)
survival = rep(30, 5) - death

df1 = data.frame(dose, death, survival)
y1 = as.matrix(df1[ , -1])
```

## Logit link

```{r}
# fit a glm model
logit_fit <- glm(
  y1 ~ dose, 
  data = df1,
  family = binomial(link = 'logit'))

summary(logit_fit)

# extract estimated beta
logit_fit$coefficients
round(logit_fit$coefficients[2], 3)

# calculate CI - choice of confint vs confint.default??
round(confint(logit_fit),3)
round(confint.default(logit_fit),3)

# extract deviance
round(logit_fit$deviance, 3)
# calculate deviance "by hand"
round(sum(residuals(logit_fit, type = 'deviance' ) ^ 2), 3)

# make prediction ??
round(predict.glm(logit_fit, newdata = data.frame(rep(0.01, 5)),type = 'response'), 3) # type = "response" gives the predicted probabilities

round(predict.glm(logit_fit,newdata=data.frame(x=0.01),type='r'),4)
```


## Probit link

## Log-log link